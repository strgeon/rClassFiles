# TODO: Add comment
# 
# Author: Scott
###############################################################################

setwd("C:/Users/Scott/SkyDrive/Documents/Courses/AnalyticsEdge/Unit7/data")
getwd()
# [1] "C:/Users/Scott/SkyDrive/Documents/Courses/AnalyticsEdge/Unit7/data"

murders = read.csv("murders.csv")

str(murders)
# 'data.frame':	51 obs. of  6 variables:
#  $ State            : Factor w/ 51 levels "Alabama","Alaska",..: 1 2 3 4 5 6 7 8 9 10 ...
#  $ Population       : int  4779736 710231 6392017 2915918 37253956 5029196 3574097 897934 601723 19687653 ...
#  $ PopulationDensity: num  94.65 1.26 57.05 56.43 244.2 ...
#  $ Murders          : int  199 31 352 130 1811 117 131 48 131 987 ...
#  $ GunMurders       : int  135 19 232 93 1257 65 97 38 99 669 ...
#  $ GunOwnership     : num  0.517 0.578 0.311 0.553 0.213 0.347 0.167 0.255 0.036 0.245 ...

statesMap = map_data("state")
str(statesMap)
# 'data.frame':	15537 obs. of  6 variables:
#  $ long     : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
#  $ lat      : num  30.4 30.4 30.4 30.3 30.3 ...
#  $ group    : num  1 1 1 1 1 1 1 1 1 1 ...
#  $ order    : int  1 2 3 4 5 6 7 8 9 10 ...
#  $ region   : chr  "alabama" "alabama" "alabama" "alabama" ...
#  $ subregion: chr  NA NA NA NA ...

ggplot(statesMap, aes(x = long, y= lat, group=group)) + geom_polygon(fill="white", color="black")
murders$region = tolower(murders$State)
str(murders)
# 'data.frame':	51 obs. of  7 variables:
#  $ State            : Factor w/ 51 levels "Alabama","Alaska",..: 1 2 3 4 5 6 7 8 9 10 ...
#  $ Population       : int  4779736 710231 6392017 2915918 37253956 5029196 3574097 897934 601723 19687653 ...
#  $ PopulationDensity: num  94.65 1.26 57.05 56.43 244.2 ...
#  $ Murders          : int  199 31 352 130 1811 117 131 48 131 987 ...
#  $ GunMurders       : int  135 19 232 93 1257 65 97 38 99 669 ...
#  $ GunOwnership     : num  0.517 0.578 0.311 0.553 0.213 0.347 0.167 0.255 0.036 0.245 ...
#  $ region           : chr  "alabama" "alaska" "arizona" "arkansas" ...

MurderMap = merge(murders, statesMap, by="region")
str(MurderMap)
# 'data.frame':	15537 obs. of  12 variables:
#  $ region           : chr  "alabama" "alabama" "alabama" "alabama" ...
#  $ State            : Factor w/ 51 levels "Alabama","Alaska",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ Population       : int  4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 ...
#  $ PopulationDensity: num  94.7 94.7 94.7 94.7 94.7 ...
#  $ Murders          : int  199 199 199 199 199 199 199 199 199 199 ...
#  $ GunMurders       : int  135 135 135 135 135 135 135 135 135 135 ...
#  $ GunOwnership     : num  0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 ...
#  $ long             : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
#  $ lat              : num  30.4 30.4 30.4 30.3 30.3 ...
#  $ group            : num  1 1 1 1 1 1 1 1 1 1 ...
#  $ order            : int  1 2 3 4 5 6 7 8 9 10 ...
#  $ subregion        : chr  NA NA NA NA ...

ggplot(MurderMap, aes(x = long, y= lat, group=group, fill = Murders)) + geom_polygon(color="black") + scale_fill_gradient(low="black", high="red", guide="legend")
ggplot(MurderMap, aes(x = long, y= lat, group=group, fill = Population)) + geom_polygon(color="black") + scale_fill_gradient(low="black", high="red", guide="legend")
MurderMap$MurderRate = (MurderMap$Murders/MurderMap$Population)*100000
str(MurderMap)
# 'data.frame':	15537 obs. of  13 variables:
#  $ region           : chr  "alabama" "alabama" "alabama" "alabama" ...
#  $ State            : Factor w/ 51 levels "Alabama","Alaska",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ Population       : int  4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 ...
#  $ PopulationDensity: num  94.7 94.7 94.7 94.7 94.7 ...
#  $ Murders          : int  199 199 199 199 199 199 199 199 199 199 ...
#  $ GunMurders       : int  135 135 135 135 135 135 135 135 135 135 ...
#  $ GunOwnership     : num  0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 0.517 ...
#  $ long             : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
#  $ lat              : num  30.4 30.4 30.4 30.3 30.3 ...
#  $ group            : num  1 1 1 1 1 1 1 1 1 1 ...
#  $ order            : int  1 2 3 4 5 6 7 8 9 10 ...
#  $ subregion        : chr  NA NA NA NA ...
#  $ MurderRate       : num  4.16 4.16 4.16 4.16 4.16 ...

ggplot(MurderMap, aes(x = long, y= lat, group=group, fill = MurderRate)) + geom_polygon(color="black") + scale_fill_gradient(low="black", high="red", guide="legend",limits=c(0,10)) 

ggplot(MurderMap, aes(x = long, y= lat, group=group, fill = GunOwnership)) + geom_polygon(color="black") + scale_fill_gradient(low="black", high="red", guide="legend")