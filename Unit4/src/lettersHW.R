# TODO: Add comment
# 
# Author: Scott
###############################################################################


setwd("C:/Users/Scott/SkyDrive/Documents/Courses/AnalyticsEdge/Unit4/data")
getwd()
# [1] "C:/Users/Scott/SkyDrive/Documents/Courses/AnalyticsEdge/Unit4/data"

letters=read.csv("letters_ABPR.csv")
str(letters)
# 'data.frame':	3116 obs. of  17 variables:
#  $ letter   : Factor w/ 4 levels "A","B","P","R": 2 1 4 2 3 4 4 1 3 3 ...
#  $ xbox     : int  4 1 5 5 3 8 2 3 8 6 ...
#  $ ybox     : int  2 1 9 9 6 10 6 7 14 10 ...
#  $ width    : int  5 3 5 7 4 8 4 5 7 8 ...
#  $ height   : int  4 2 7 7 4 6 4 5 8 8 ...
#  $ onpix    : int  4 1 6 10 2 6 3 3 4 7 ...
#  $ xbar     : int  8 8 6 9 4 7 6 12 5 8 ...
#  $ ybar     : int  7 2 11 8 14 7 7 2 10 5 ...
#  $ x2bar    : int  6 2 7 4 8 3 5 3 6 7 ...
#  $ y2bar    : int  6 2 3 4 1 5 5 2 3 5 ...
#  $ xybar    : int  7 8 7 6 11 8 6 10 12 7 ...
#  $ x2ybar   : int  6 2 3 8 6 4 5 2 5 6 ...
#  $ xy2bar   : int  6 8 9 6 3 8 7 9 4 6 ...
#  $ xedge    : int  2 1 2 6 0 6 3 2 4 3 ...
#  $ xedgeycor: int  8 6 7 11 10 6 7 6 10 9 ...
#  $ yedge    : int  7 2 5 8 4 7 5 3 4 8 ...
#  $ yedgexcor: int  10 7 11 7 8 7 8 8 8 9 ...

letters$isB = as.factor(letters$letter == "B")
table(letters$isB)
# 
# FALSE  TRUE 
#  2350   766 

library(caTools)
set.seed(1000)
split=sample.split(letters$isB, SplitRatio=0.5)
train=subset(letters,split==TRUE)
test=subset(letters,split==FALSE)
table(test$isB)
# 
# FALSE  TRUE 
#  1175   383 
1175/(383+1175)
# [1] 0.754172

set.seed(1000)
CARTb = rpart(isB ~ . - letter, data=train, method="class")
prp(CARTb)
# 
set.seed(1000)
pred=predict(CARTb, newdata=test, type="class")
table(pred)
table(pred,test$isB)
#        
# pred    FALSE TRUE
#   FALSE  1118   43
#   TRUE     57  340

(1118+340)/(1118+340+57+43)
# [1] 0.9358151

library(randomForest)

# Build random forest model
set.seed(1000)
lfor = randomForest(isB ~ . - letter, data=train)

pfor = predict(lfor,newdata=test)
table(test$isB,pfor)
#        pfor
#         FALSE TRUE
#   FALSE  1165   10
#   TRUE      9  374
(1165+374)/nrow(test)
# [1] 0.9878049

str(letters)
# 'data.frame':	3116 obs. of  18 variables:
#  $ letter   : Factor w/ 4 levels "A","B","P","R": 2 1 4 2 3 4 4 1 3 3 ...
#  $ xbox     : int  4 1 5 5 3 8 2 3 8 6 ...
#  $ ybox     : int  2 1 9 9 6 10 6 7 14 10 ...
#  $ width    : int  5 3 5 7 4 8 4 5 7 8 ...
#  $ height   : int  4 2 7 7 4 6 4 5 8 8 ...
#  $ onpix    : int  4 1 6 10 2 6 3 3 4 7 ...
#  $ xbar     : int  8 8 6 9 4 7 6 12 5 8 ...
#  $ ybar     : int  7 2 11 8 14 7 7 2 10 5 ...
#  $ x2bar    : int  6 2 7 4 8 3 5 3 6 7 ...
#  $ y2bar    : int  6 2 3 4 1 5 5 2 3 5 ...
#  $ xybar    : int  7 8 7 6 11 8 6 10 12 7 ...
#  $ x2ybar   : int  6 2 3 8 6 4 5 2 5 6 ...
#  $ xy2bar   : int  6 8 9 6 3 8 7 9 4 6 ...
#  $ xedge    : int  2 1 2 6 0 6 3 2 4 3 ...
#  $ xedgeycor: int  8 6 7 11 10 6 7 6 10 9 ...
#  $ yedge    : int  7 2 5 8 4 7 5 3 4 8 ...
#  $ yedgexcor: int  10 7 11 7 8 7 8 8 8 9 ...
#  $ isB      : Factor w/ 2 levels "FALSE","TRUE": 2 1 1 2 1 1 1 1 1 1 ...

letters$letter = as.factor( letters$letter )
str(letters)
# 'data.frame':	3116 obs. of  18 variables:
#  $ letter   : Factor w/ 4 levels "A","B","P","R": 2 1 4 2 3 4 4 1 3 3 ...
#  $ xbox     : int  4 1 5 5 3 8 2 3 8 6 ...
#  $ ybox     : int  2 1 9 9 6 10 6 7 14 10 ...
#  $ width    : int  5 3 5 7 4 8 4 5 7 8 ...
#  $ height   : int  4 2 7 7 4 6 4 5 8 8 ...
#  $ onpix    : int  4 1 6 10 2 6 3 3 4 7 ...
#  $ xbar     : int  8 8 6 9 4 7 6 12 5 8 ...
#  $ ybar     : int  7 2 11 8 14 7 7 2 10 5 ...
#  $ x2bar    : int  6 2 7 4 8 3 5 3 6 7 ...
#  $ y2bar    : int  6 2 3 4 1 5 5 2 3 5 ...
#  $ xybar    : int  7 8 7 6 11 8 6 10 12 7 ...
#  $ x2ybar   : int  6 2 3 8 6 4 5 2 5 6 ...
#  $ xy2bar   : int  6 8 9 6 3 8 7 9 4 6 ...
#  $ xedge    : int  2 1 2 6 0 6 3 2 4 3 ...
#  $ xedgeycor: int  8 6 7 11 10 6 7 6 10 9 ...
#  $ yedge    : int  7 2 5 8 4 7 5 3 4 8 ...
#  $ yedgexcor: int  10 7 11 7 8 7 8 8 8 9 ...
#  $ isB      : Factor w/ 2 levels "FALSE","TRUE": 2 1 1 2 1 1 1 1 1 1 ...

set.seed(2000)
split=sample.split(letters$letter, SplitRatio=0.5)
train=subset(letters,split==TRUE)
test=subset(letters,split==FALSE)
table(test$letter)
# 
#   A   B   P   R 
# 395 383 401 379 

401/nrow(test)
# [1] 0.2573813

#create CART model
set.seed(2000)
CARTb = rpart(letter ~ . - isB, data=train, method="class")
prp(CARTb)

pred=predict(CARTb, newdata=test, type="class")
table(pred,test$letter)
#     
# pred   A   B   P   R
#    A 348   8   2  10
#    B   4 318  21  24
#    P   0  12 363   5
#    R  43  45  15 340


(348+318+363+340)/nrow(test)
# [1] 0.8786906

#create random forest model
lfor = randomForest(letter ~ . - isB, data=train)

pfor = predict(lfor,newdata=test)
table(test$letter,pfor)
#    pfor
#       A   B   P   R
#   A 390   0   3   2
#   B   0 380   1   2
#   P   0   6 393   2
#   R   0  10   0 369
(390+380+393+369)/nrow(test)
# [1] 0.9833119




